<!DOCTYPE html>
<html>

<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>NX Server Configuration Page</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <meta name='viewport' content='width=device-width, initial-scale=1'>

    <style>
        li:hover.hover {
            background: darkcyan;
            transition: 0.2s linear;
        }

        li:not(:hover).hover {
            transition: 0.2s linear;
        }
    </style>
</head>

<body>

    <script>
        function refreshWLAN() {
            const Http = new XMLHttpRequest();
            const url = 'http://192.168.4.1/api/getWLANNetworks';
            Http.open("GET", url);
            Http.send();
            const loadingLabel = document.getElementById("loading");
            loadingLabel.hidden = false;

            Http.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {
                    loadingLabel.hidden = true;
                    var obj = JSON.parse(Http.responseText);

                    var ul = document.getElementsByTagName("ul");
                    for (var i = 0; i < obj.networks.length; i++) {
                        let network = obj.networks[i];

                        let listItem = document.createElement("li");
                        listItem.classList.add("mb-2", "border", "shadow-sm", "p-2", "hover");

                        let wrapper = document.createElement("div");
                        wrapper.classList.add("row", "pr-4", "pl-4");

                        let label = document.createElement("label");
                        label.innerText = network;
                        wrapper.appendChild(label);

                        let button = document.createElement("button");
                        button.classList.add("btn", "btn-sm", "btn-dark", "ml-auto");
                        button.textContent = "Select";
                        button.addEventListener("click", function () {
                            var ssidField = document.getElementById("ssid");
                            if (ssidField) {
                                ssidField.value = network;
                            }
                        });

                        wrapper.appendChild(button);
                        listItem.appendChild(wrapper);
                        ul[0].appendChild(listItem);
                    }
                }
            }
        }
    </script>

    <main role="main" class="col-md-9 ml-sm-auto col-lg-10 pt-3 px-4">
        <div class="row">
            <div class="col-lg-5">
                <form action="/api/configureServer" method="POST">
                    <div class="mb-3">
                        <label for="ssid">SSID Name:</label>
                        <input name="ssid" required type="text" class="form-control" id="ssid"
                            placeholder="My Network Name">
                    </div>
                    <div class="mb-3">
                        <label for="pass">Password</label>
                        <input name="pass" required type="text" class="form-control" id="pass"
                            placeholder="My Network Password Name">
                    </div>
                    <br>
                    <button class="btn btn-primary btn-lg col-3" type="submit">Submit</button>
                </form>
            </div>
            <div class="col-lg-5">
                <div style="height:500px;border:1px solid #ccc;overflow:auto;">
                    <div style="border-radius: 0" class="shadow-sm alert alert-dark row">
                        <div class="col-10">
                            <h4>WLAN Browser</h4>
                        </div>
                        <div>
                            <button onclick="refreshWLAN()" class="btn btn-primary">Refresh</button>
                        </div>
                    </div>
                    <h2 hidden id="loading">
                        Loading.....
                    </h2>
                    <ul class="container" style="list-style-type:none" id="wifi-list">
                        <!-- will be dynamically generated -->
                    </ul>
                </div>
            </div>
        </div>
    </main>

</body>

</html>